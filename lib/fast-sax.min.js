"use strict";var Type;!function(t){t[t.ELEMENT=0]="ELEMENT",t[t.CLOSE_ELEMENT=1]="CLOSE_ELEMENT",t[t.COMMENT=2]="COMMENT",t[t.CDATA=3]="CDATA"}(Type||(Type={}));var NAME_START_CHAR="[:A-Z_a-z]",NAME_CHAR="[:A-Z_a-z.0-9-]",NAME=""+NAME_START_CHAR+NAME_CHAR+"*",S="[ \\r\\n\\t]*",ATTRIBUTE=S+"("+NAME+")"+S+"="+S+"[\"']([^\"']*)[\"']"+S,noOp=function(){},FastSax=function(){function u(){this.nameRegExp=new RegExp("("+NAME+")","gm"),this.attributeRegExp=new RegExp(ATTRIBUTE,"gm"),this.onText=noOp,this.onElementStart=noOp,this.onElementEnd=noOp,this.onCData=noOp,this.onComment=noOp}return u.prototype.parse=function(t){for(var e=this,E=null,n="\ufeff"===t.charAt(0)?1:0,i=n,r=n;r<t.length;r++)if(null!==E){if(E===Type.ELEMENT){if(-1===(A=t.indexOf(u.ELEMENT_SUFFIX,r)))break;var T=null;this.nameRegExp.lastIndex=r;var s=this.nameRegExp.exec(t);null!==s&&(T=s[1],r=this.nameRegExp.lastIndex),null===T&&(T=t.substring(r,A)),T&&(this.onElementStart(T,function(){return e.extractAttributes(t,r,A)}),t[A-1]===u.FORWARD_SLASH&&this.onElementEnd(T)),r=A}else if(E===Type.CLOSE_ELEMENT){if(-1===(A=t.indexOf(u.ELEMENT_SUFFIX,r)))break;this.onElementEnd(t.substring(r,A)),r=A}else if(E===Type.CDATA){if(-1===(A=t.indexOf(u.CDATA_SUFFIX,r)))break;this.onCData(function(){return t.substring(r,A)}),r=A+2}else if(E===Type.COMMENT){var A;if(-1===(A=t.indexOf(u.COMMENT_SUFFIX,r)))break;this.onComment(function(){return t.substring(r,A)}),r=A+2}i=r+1,E=null}else if(t[r]===u.OPEN_BRACKET){0<r-i&&this.onText(function(){return t.substring(i,r)});var a=t[r+1];a===u.FORWARD_SLASH?(E=Type.CLOSE_ELEMENT,r+=1):a===u.EXCLAMATION_POINT?u.startsWith(t,r+2,u.CDATA_PREFIX)?(E=Type.CDATA,r+=8):u.startsWith(t,r+2,u.COMMENT_PREFIX)&&(E=Type.COMMENT,r+=3):E=Type.ELEMENT}},u.prototype.extractAttributes=function(t,e,E){var n=t.substring(e,E);e=0,E=n.length;var i={};for(this.attributeRegExp.lastIndex=e;this.attributeRegExp.lastIndex<E;){var r=this.attributeRegExp.exec(n);if(null===r)break;var T=r[1],s=r[2];i[T]=s}return i},u.startsWith=function(t,e,E){return t.startsWith?t.startsWith(E,e):t.substr(e,E.length)===E},u.OPEN_BRACKET="<",u.FORWARD_SLASH="/",u.EXCLAMATION_POINT="!",u.EQUALS="=",u.SPACE=" ",u.TAB="\t",u.NEW_LINE="\n",u.CARRIAGE_RETURN="\r",u.SINGLE_QUOTE="'",u.DOUBLE_QUOTE='"',u.CDATA_PREFIX="[CDATA[",u.CDATA_SUFFIX="]]>",u.ELEMENT_SUFFIX=">",u.COMMENT_PREFIX="--",u.COMMENT_SUFFIX="--\x3e",u}();module.exports=FastSax;